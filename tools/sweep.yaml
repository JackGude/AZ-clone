# sweep.yaml

program: pipeline.train
method: bayes
project: alphazero-chess-2

metric:
  name: best/weighted_validation_loss
  goal: minimize

command:
  - ${env}
  - ${interpreter}
  - -m
  - ${program}
  - ${args}
  - ${if:load-weights} --load-weights ${endif}

parameters:
  # --- Locked parameters ---
  max-epochs:
    value: 20
  patience:
    value: 3
  load-weights:
    value: true
  n-res-blocks:
    value: 40
  channels:
    value: 384

  # --- Swept training parameters ---
  # MUST BE FLOATS
  learning-rate:
    distribution: log_uniform_values
    min: 7.0e-4
    max: 5.0e-3
  weight-decay:
    distribution: log_uniform_values
    min: 5.0e-5
    max: 5.0e-3

  # --- Swept loss weights ---
  # policy-loss-weight:
  #   distribution: uniform
  #   min: 0.75
  #   max: 1.5
  # load-balance-loss-weight:
  #   distribution: uniform
  #   min: 0.01
  #   max: 0.15
  # value-loss-weight:
  #   distribution: uniform
  #   min: 0.5
  #   max: 1.5
  # legality-loss-weight:
  #   distribution: uniform
  #   min: 0.2
  #   max: 0.8